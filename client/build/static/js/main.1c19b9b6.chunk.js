(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{25:function(e,t,a){},26:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var c=a(1),s=a(2),n=a.n(s),r=a(19),o=a.n(r),l=(a(25),a(3)),i=(a(26),a(4)),u=a.n(i),d=Object(s.createContext)(),j=function(e){var t=Object(s.useState)({}),a=Object(l.a)(t,2),n=a[0],r=a[1];return Object(c.jsx)(d.Provider,{value:[n,r],children:e.children})},h=function(e){var t=Object(s.useContext)(d),a=Object(l.a)(t,2),n=(a[0],a[1]),r=Object(s.useState)(""),o=Object(l.a)(r,2),i=o[0],j=o[1],h=Object(s.useState)("login"),b=Object(l.a)(h,2),m=b[0],O=b[1],g=Object(s.useState)(""),x=Object(l.a)(g,2),p=x[0],f=x[1],v=Object(s.useState)(""),k=Object(l.a)(v,2),N=k[0],C=k[1],S=Object(s.useState)(""),w=Object(l.a)(S,2),D=w[0],y=w[1],I=Object(s.useState)(""),_=Object(l.a)(I,2),A=_[0],E=_[1],T=Object(s.useState)(""),M=Object(l.a)(T,2),P=M[0],V=M[1];Object(s.useEffect)((function(){var t=localStorage.getItem("userEmail"),a=localStorage.getItem("userPassword");if(null!==t){var c={email:t,password:a};u.a.post("/api/users/login",c).then((function(a){u.a.get("/api/users",{params:{email:t}}).then((function(t){var a=t.data;n(a),e.setLoggedIn(!0)})).catch((function(e){console.log(e)}))}))}}),[]);return Object(c.jsxs)("div",{className:"auth-container",children:["login"===m&&Object(c.jsxs)("div",{className:"login-container",children:[Object(c.jsx)("h1",{children:"Login with an existing account"}),Object(c.jsxs)("form",{children:[Object(c.jsx)("input",{className:"email"===i[0]?"error":void 0,onChange:function(e){return f(e.target.value)},placeholder:"email"===i[0]?i[1]:"Email",name:"email",value:p}),Object(c.jsx)("input",{className:"password"===i[0]?"error":void 0,onChange:function(e){return C(e.target.value)},placeholder:"password"===i[0]?i[1]:"Password",name:"password",value:N}),Object(c.jsx)("button",{onClick:function(t,a,c){t.preventDefault();var s={email:p,password:N};u.a.post("/api/users/login",s).then((function(t){switch(console.log(t.data),t.data){case'"email" is not allowed to be empty':j(["email","Email cannot be empty"]);break;case'"email" length must be at least 6 characters long':j(["email","Email must be at least 6 characters long"]),f("");break;case'"email" must be a valid email':j(["email","Must be a valid email"]),f("");break;case"email-not-found":j(["email","Email not found"]);break;case'"password" is not allowed to be empty':j(["password","Password cannot be empty"]);break;case'"password" length must be at least 6 characters long':j(["password","Password is too short"]),C("");break;case"invalid-password":j(["password","Invalid password"]),C("");break;case"user-not-authorized":j("not-authorized"),f(""),C("");break;default:var a=t.headers["auth-token"];localStorage.setItem("userToken",a),localStorage.setItem("userEmail",p),localStorage.setItem("userPassword",N),e.setLoggedIn(!0)}u.a.get("/api/users",{params:{email:p}}).then((function(e){var t=e.data;n(t)})).catch((function(e){console.log("Error: "+e)}))}))},children:"Login"})]}),"not-authorized"===i&&Object(c.jsxs)("p",{children:["Not approved yet.",Object(c.jsx)("br",{}),"Please wait for Manager's approval."]}),Object(c.jsx)("p",{className:"register-link",onClick:function(){return O("register")},children:"Register a new account"})]}),"register"===m&&Object(c.jsxs)("div",{className:"register-container",children:[Object(c.jsx)("h1",{children:"Register a new account"}),"registered"!==i&&Object(c.jsxs)("form",{className:"input-main",children:[Object(c.jsx)("input",{className:"name"===i[0]?"error":void 0,onChange:function(e){return y(e.target.value)},placeholder:"name"===i[0]?i[1]:"Name",name:"name",value:D}),Object(c.jsx)("input",{className:"email"===i[0]?"error":void 0,onChange:function(e){return E(e.target.value)},placeholder:"email"===i[0]?i[1]:"Email",name:"email",value:A}),Object(c.jsx)("input",{className:"password"===i[0]?"error":void 0,onChange:function(e){return V(e.target.value)},placeholder:"password"===i[0]?i[1]:"Password",name:"password",value:P}),Object(c.jsx)("button",{onClick:function(e){e.preventDefault();var t={name:D,email:A,password:P};u.a.post("/api/users/register",t).then((function(e){switch(e.data){case'"name" is not allowed to be empty':j(["name","Name cannot be empty"]);break;case'"email" is not allowed to be empty':j(["email","Email cannot be empty"]);break;case'"email" length must be at least 6 characters long':j(["email","Email must be at least 6 characters long"]),E("");break;case'"email" must be a valid email':j(["email","Must be a valid email"]),E("");break;case"email-duplicate":j(["email","doubleEmails"]),E("");break;case'"password" is not allowed to be empty':j(["password","Password cannot be empty"]);break;case'"password" length must be at least 6 characters long':j(["password","Password is too short"]),V("");break;default:j("registered"),y(""),E(""),V("")}})).catch((function(e){console.log(e)}))},children:"Register"})]}),"registered"===i&&Object(c.jsxs)("p",{children:["Successfully registered!",Object(c.jsx)("br",{}),"Please wait for Manager's approval."]}),Object(c.jsx)("p",{className:"login-link",onClick:function(){return O("login")},children:"Login with an existing account"})]})]})},b=function(e){localStorage.getItem("userToken");var t=Object(s.useState)(""),a=Object(l.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)(""),i=Object(l.a)(o,2),d=i[0],j=i[1],h=Object(s.useState)(""),b=Object(l.a)(h,2),m=b[0],O=b[1],g=Object(s.useState)(""),x=Object(l.a)(g,2),p=x[0],f=x[1],v=Object(s.useState)(""),k=Object(l.a)(v,2),N=k[0],C=k[1],S=Object(s.useState)(""),w=Object(l.a)(S,2),D=w[0],y=w[1];return Object(c.jsxs)("div",{className:"schools-container",children:[Object(c.jsxs)("div",{className:"section-nav",children:[Object(c.jsx)("div",{className:"breadcrumb",children:Object(c.jsx)("p",{children:"Schools"})}),Object(c.jsxs)("div",{className:"functions",children:[Object(c.jsx)("button",{className:"button-assign-manager",onClick:function(){return r("assign-manager")},children:"assign manager"}),Object(c.jsx)("button",{className:"button-create-school",onClick:function(){return r("create-school")},children:"create"})]})]}),Object(c.jsxs)("div",{className:"functions-container",children:["create-school"===n&&Object(c.jsxs)("form",{children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"text",value:d,placeholder:"School name",onChange:function(e){return j(e.target.value)},autoFocus:!0}),Object(c.jsx)("input",{type:"text",value:m,placeholder:"School address",onChange:function(e){return O(e.target.value)}}),Object(c.jsx)("input",{type:"text",value:p,placeholder:"School contact number",onChange:function(e){return f(e.target.value)}})]}),Object(c.jsx)("button",{onClick:function(t){t.preventDefault();var a={name:d,address:m,contactNumber:p};u.a.post("/api/schools/createSchool",a).then((function(t){e.readAllSchools(),r("")})).catch((function(e){console.log(e)}))},children:"Add school"}),Object(c.jsx)("button",{onClick:function(){return r("")},children:"Cancel"})]}),"assign-manager"===n&&Object(c.jsxs)("form",{children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("label",{children:"Choose a school: "}),Object(c.jsxs)("select",{value:N,onChange:function(e){return C(e.target.value)},children:[Object(c.jsx)("option",{children:"Please choose a school"}),e.schools.map((function(e){return Object(c.jsx)("option",{value:e._id,children:e.name},e._id)}))]}),Object(c.jsx)("br",{}),Object(c.jsx)("label",{children:"Choose a manager: "}),Object(c.jsxs)("select",{value:D,onChange:function(e){return y(e.target.value)},children:[Object(c.jsx)("option",{children:"Please choose a manager"}),e.managers.map((function(e){return Object(c.jsx)("option",{value:e._id,children:e.name},e._id)}))]})]}),Object(c.jsx)("button",{onClick:function(t){return function(t){t.preventDefault();var a=e.managers.filter((function(e){return e._id===D})),c=e.schools.filter((function(e){return e._id===N})),s={schoolId:c[0]._id,schoolName:c[0].name,managerId:a[0]._id,managerName:a[0].name};u.a.put("/api/schools/addManager",s).then((function(t){u.a.put("/api/managers/addSchoolRef",s).then((function(t){e.readAllSchools(),r("")})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}(t)},children:"Add manager"}),Object(c.jsx)("button",{onClick:function(){return r("")},children:"Cancel"})]})]}),Object(c.jsx)("div",{className:"schools-info",children:e.schools.map((function(t){return Object(c.jsxs)("div",{className:"school-info",children:[Object(c.jsx)("h3",{children:t.name}),Object(c.jsxs)("p",{children:["Address: ",t.address]}),Object(c.jsxs)("p",{children:["Manager: ",t.manager&&t.manager.managerName]}),Object(c.jsx)("button",{onClick:function(a){return function(t,a){t.preventDefault(),u.a.delete("/api/schools/deleteSchool/"+a).then((function(t){e.readAllSchools()})).catch((function(e){console.log(e)}))}(a,t._id)},children:"Delete school"}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{})]},t._id)}))})]})},m=function(e){localStorage.getItem("userToken");var t=Object(s.useState)(""),a=Object(l.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)(""),i=Object(l.a)(o,2),d=i[0],j=i[1],h=Object(s.useState)(""),b=Object(l.a)(h,2),m=b[0],O=b[1],g=Object(s.useState)(""),x=Object(l.a)(g,2),p=x[0],f=x[1];return Object(c.jsxs)("div",{className:"managers-container",children:[Object(c.jsxs)("div",{className:"section-nav",children:[Object(c.jsx)("div",{className:"breadcrumb",children:Object(c.jsx)("p",{children:"Managers"})}),Object(c.jsx)("div",{className:"functions",children:Object(c.jsx)("button",{className:"button-create-manager",onClick:function(){return r("create-manager")},children:"create"})})]}),Object(c.jsx)("div",{className:"functions-container",children:"create-manager"===n&&Object(c.jsxs)("form",{className:"add-school",children:[Object(c.jsx)("input",{type:"text",value:d,placeholder:"Manager name",onChange:function(e){return j(e.target.value)},autoFocus:!0}),Object(c.jsx)("input",{type:"text",value:m,placeholder:"Manager email",onChange:function(e){return O(e.target.value)}}),Object(c.jsx)("input",{type:"text",value:p,placeholder:"Manager password",onChange:function(e){return f(e.target.value)}}),Object(c.jsx)("button",{onClick:function(t){t.preventDefault();var a={name:d,email:m,password:p};u.a.post("/api/managers/createManager",a).then((function(t){e.readAllManagers(),r(""),j(""),O(""),f("")})).catch((function(e){console.log(e)}))},children:"Create manager"}),Object(c.jsx)("button",{onClick:function(){return r("")},children:"Cancel"})]})}),Object(c.jsx)("div",{className:"managers-info",children:e.managers.map((function(t){return Object(c.jsxs)("div",{className:"manager-info",children:[Object(c.jsx)("h3",{children:t.name}),Object(c.jsxs)("p",{children:["Email: ",t.email]}),Object(c.jsxs)("p",{children:["School: ",t.school.schoolName]}),Object(c.jsx)("button",{onClick:function(a){return function(t,a){t.preventDefault(),u.a.delete("/api/managers/deleteManager/"+a).then((function(t){e.readAllManagers()})).catch((function(e){console.log(e)}))}(a,t._id)},children:"Delete manager"}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{})]},t._id)}))})]})},O=function(e){var t=localStorage.getItem("userToken");return Object(c.jsx)("div",{className:"teachers-container",children:Object(c.jsx)("div",{className:"teacher-cards",children:e.teachers.map((function(a){return Object(c.jsxs)("div",{className:"class-card",children:[Object(c.jsx)("h3",{children:a.name}),Object(c.jsxs)("p",{children:["Auth status: ",a.isAuthed?"Authorized":"Unauthorized"]}),Object(c.jsx)("button",{onClick:function(c){return function(a,c){a.preventDefault(),u.a.put("/api/teachers/authTeacher/"+c,{headers:{"auth-token":t}}).then((function(t){console.log(t.data),e.readAllTeachers()})).catch((function(e){console.log(e)}))}(c,a._id)},children:"Authorize"}),Object(c.jsx)("button",{onClick:function(c){return function(a,c){a.preventDefault(),u.a.delete("/api/teachers/deleteTeacher/"+c,{headers:{"auth-token":t}}).then((function(t){console.log(t.data),e.readAllTeachers()})).catch((function(e){console.log(e)}))}(c,a._id)},children:"Remove teacher"})]},a._id)}))})})},g=function(e){var t=localStorage.getItem("userToken"),a=Object(s.useContext)(d),n=Object(l.a)(a,2),r=n[0],o=(n[1],Object(s.useState)("")),i=Object(l.a)(o,2),j=i[0],h=i[1],b=Object(s.useState)(""),m=Object(l.a)(b,2),O=m[0],g=m[1];return Object(c.jsxs)("div",{className:"classes-container",children:[Object(c.jsxs)("form",{className:"add-class",children:[Object(c.jsx)("input",{type:"text",value:j,placeholder:"Class name",onChange:function(e){return h(e.target.value)}}),Object(c.jsx)("input",{type:"text",value:O,placeholder:"Class book",onChange:function(e){return g(e.target.value)}}),Object(c.jsx)("button",{onClick:function(t){t.preventDefault();var a=localStorage.getItem("userToken"),c={name:j,book:O,localTeacherName:r.name,localTeacherId:r._id};u.a.post("/api/classes/create",c,{headers:{"auth-token":a}}).then((function(t){var c=r.classes,s={name:j,id:t.data,teacherId:r._id,date:Date.now()};c.push(s);var n={userId:r._id,classes:c};u.a.put("/api/teachers/addClass",n,{headers:{"auth-token":a}}).then((function(t){e.readAllClasses()})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},children:"Add class"})]}),Object(c.jsx)("div",{className:"class-cards",children:e.classes.map((function(a){return Object(c.jsxs)("div",{className:"class-card",children:[Object(c.jsx)("h3",{children:a.name}),Object(c.jsxs)("p",{children:["Book: ",a.book]}),Object(c.jsxs)("p",{children:["Local Teacher: ",a.localTeacherName]}),Object(c.jsx)("button",{onClick:function(t){return function(t){var a=localStorage.getItem("userToken");u.a.get("./api/classes/"+t,{headers:{"auth-token":a}}).then((function(t){console.log(t.data[0]),e.setClassData(t.data[0]),e.setView("class")})).catch((function(e){console.error("Error: "+e)}))}(a._id)},children:"View class"}),Object(c.jsx)("br",{}),Object(c.jsx)("button",{onClick:function(c){return function(a){u.a.delete("/api/classes/delete/"+a).then((function(c){var s=r.classes.filter((function(e){return e.id!==a}));console.log(s);var n={userId:r._id,classes:s};u.a.put("/api/teachers/deleteClass",n,{headers:{"auth-token":t}}).then((function(t){e.readAllClasses()})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}(a._id)},className:"delete-class-button",children:"Delete class"})]},a._id)}))})]})},x=function(e){var t=Object(s.useState)(""),a=Object(l.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)(""),i=Object(l.a)(o,2),d=i[0],j=i[1],h=function(t){var a=e.classData,c=a.students.map((function(e){return e._id})).indexOf(t);a.students.splice(c,1),u.a.put("/api/classes/deleteStudent",a).then((function(t){console.log(t.data),function(t){var a=localStorage.getItem("userToken");u.a.get("./api/classes/"+t,{headers:{"auth-token":a}}).then((function(t){console.log(t.data[0]),e.setClassData(t.data[0])})).catch((function(e){console.error("Error: "+e)}))}(e.classData._id)})).catch((function(e){console.log(e)}))};return Object(c.jsxs)("div",{className:"class-container",children:[Object(c.jsxs)("div",{className:"class-details-container",children:[Object(c.jsx)("h2",{children:e.classData.name}),Object(c.jsx)("h2",{children:e.classData.book}),Object(c.jsx)("h2",{children:e.classData.localTeacher})]}),Object(c.jsxs)("form",{className:"add-student-container",children:[Object(c.jsx)("input",{type:"text",value:n,placeholder:"name...",onChange:function(e){return r(e.target.value)}}),Object(c.jsx)("input",{type:"text",value:d,placeholder:"age...",onChange:function(e){return j(e.target.value)}}),Object(c.jsx)("button",{onClick:function(t){t.preventDefault();var a=e.classData,c={name:n,age:d,class:e.classData.name,_id:Math.floor(1e5*Math.random())};a.students.push(c),u.a.put("/api/classes/createStudent",e.classData).then((function(e){console.log(e.data),r(""),j("")})).catch((function(e){console.log(e)}))},children:"Add student"})]}),Object(c.jsx)("div",{className:"students-container",children:e.classData.students.map((function(e){return Object(c.jsxs)("div",{className:"student-card",children:[Object(c.jsx)("h3",{children:e.name}),Object(c.jsxs)("p",{children:["Age: ",e.age]}),Object(c.jsx)("button",{onClick:function(t){return h(e._id)},children:"Remove student"})]})}))})]})},p=a(7),f=a(9),v=a(10),k=a(6),N=a.p+"static/media/circle.423a605e.png",C=function(e){var t=localStorage.getItem("userToken"),a=Object(s.useState)("default"),n=Object(l.a)(a,2),r=n[0],o=n[1],i=Object(s.useContext)(d),j=Object(l.a)(i,2),h=j[0],C=(j[1],Object(s.useState)({})),S=Object(l.a)(C,2),w=S[0],D=S[1],y=Object(s.useState)({}),I=Object(l.a)(y,2),_=I[0],A=I[1],E=Object(s.useState)({}),T=Object(l.a)(E,2),M=T[0],P=T[1],V=Object(s.useState)({}),L=Object(l.a)(V,2),z=L[0],R=L[1],B=Object(s.useState)({}),F=Object(l.a)(B,2),J=F[0],U=F[1],q=function(){u.a.get("./api/schools").then((function(e){D(e.data),u.a.get("./api/managers").then((function(e){A(e.data),o("schools")})).catch((function(e){console.error("Error: "+e)}))})).catch((function(e){console.error("Error: "+e)}))},G=function(){u.a.get("./api/managers").then((function(e){A(e.data),o("managers")})).catch((function(e){console.error("Error: "+e)}))},H=function(){u.a.get("./api/teachers",{headers:{"auth-token":t}}).then((function(e){P(e.data),o("teachers")})).catch((function(e){console.error("Error: "+e)}))},K=function(){u.a.get("./api/classes").then((function(e){R(e.data),o("classes")})).catch((function(e){console.error("Error: "+e)}))},Q=function(){var e=h.classes.map((function(e){return e.id}));console.log(e),u.a.get("./api/classes/readAuthorizedClasses",{params:{classIds:e}}).then((function(e){R(e.data),o("classes")})).catch((function(e){console.error("Error: "+e)}))};return Object(c.jsxs)("div",{className:"dashboard",children:[Object(c.jsxs)("div",{className:"navigation-container",children:[Object(c.jsxs)("div",{className:"links",children:[Object(c.jsx)("img",{src:N,alt:"profile",width:"60px"}),Object(c.jsxs)("p",{children:[h.name,Object(c.jsx)("br",{}),Object(c.jsx)("i",{children:h.authority})]}),Object(c.jsxs)("p",{className:"link",onClick:function(){return o("default")},children:[Object(c.jsx)(k.a,{className:"icon"}),Object(c.jsx)("br",{}),"Dashboard"]}),"admin"===h.authority&&Object(c.jsxs)("p",{className:"link",onClick:q,children:[Object(c.jsx)(p.b,{className:"icon"}),Object(c.jsx)("br",{}),"Schools"]}),"admin"===h.authority&&Object(c.jsxs)("p",{className:"link",onClick:G,children:[Object(c.jsx)(k.b,{className:"icon"}),Object(c.jsx)("br",{}),"Managers"]}),"admin"===h.authority&&Object(c.jsxs)("p",{className:"link",onClick:H,children:[Object(c.jsx)(f.a,{className:"icon"}),Object(c.jsx)("br",{}),"Teachers"]}),Object(c.jsxs)("p",{className:"link",onClick:"admin"===h.authority?K:Q,children:[Object(c.jsx)(v.a,{className:"icon"}),Object(c.jsx)("br",{}),"Classes"]})]}),Object(c.jsx)("div",{className:"logout",children:Object(c.jsx)("p",{onClick:function(){localStorage.clear(),e.setLoggedIn(!1)},children:Object(c.jsx)(p.a,{})})})]}),Object(c.jsxs)("div",{className:"content-container",children:["default"===r&&Object(c.jsxs)("div",{className:"default-container",children:["admin"===h.authority&&Object(c.jsxs)("div",{className:"section-card",children:[Object(c.jsx)("h1",{children:"Schools"}),Object(c.jsx)(p.b,{className:"icon"}),Object(c.jsx)("button",{onClick:q,children:"View"})]}),"admin"===h.authority&&Object(c.jsxs)("div",{className:"section-card",children:[Object(c.jsx)("h1",{children:"Managers"}),Object(c.jsx)(k.b,{className:"icon"}),Object(c.jsx)("button",{onClick:G,children:"View"})]}),"admin"===h.authority&&Object(c.jsxs)("div",{className:"section-card",children:[Object(c.jsx)("h1",{children:"Teachers"}),Object(c.jsx)(f.a,{className:"icon"}),Object(c.jsx)("button",{onClick:H,children:"View"})]}),"admin"===h.authority&&Object(c.jsxs)("div",{className:"section-card",children:[Object(c.jsx)("h1",{children:"Classes"}),Object(c.jsx)(v.a,{className:"icon"}),Object(c.jsx)("button",{onClick:"admin"===h.authority?K:Q,children:"View"})]})]}),"schools"===r&&Object(c.jsx)(b,{setView:o,userData:h,schools:w,readAllSchools:q,managers:_}),"managers"===r&&Object(c.jsx)(m,{setView:o,userData:h,managers:_,readAllManagers:G,schools:w}),"teachers"===r&&Object(c.jsx)(O,{setView:o,teachers:M,setTeachers:P,readAllTeachers:H}),"classes"===r&&Object(c.jsx)(g,{setView:o,userData:h,classes:z,classData:J,setClassData:U,readAllClasses:K}),"class"===r&&Object(c.jsx)(x,{setView:o,userData:h,classes:z,classData:J,setClassData:U})]})]})};var S=function(){var e=Object(s.useState)(!1),t=Object(l.a)(e,2),a=t[0],n=t[1];return Object(c.jsx)(j,{children:Object(c.jsxs)("div",{className:"app",children:[!a&&Object(c.jsx)(h,{setLoggedIn:n}),a&&Object(c.jsx)(C,{setLoggedIn:n})]})})};o.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(S,{})}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.1c19b9b6.chunk.js.map